{"version":3,"file":"datastore.js","names":["dataStore","getDataStore","setupLmdbStore","require","gatsbyRedux","requireFromInstalledGatsbyDist","emitter","on"],"sources":["../../src/datastore/datastore.ts"],"sourcesContent":["import { requireFromInstalledGatsbyDist } from \"./../core-utils/create-require-from-path\"\nimport { IDataStore } from \"./types\"\nimport { emitter } from \"../redux\"\n\nlet dataStore: IDataStore\n\nexport function getDataStore(): IDataStore {\n  if (!dataStore) {\n    const { setupLmdbStore } = require(`./lmdb/lmdb-datastore`)\n    dataStore = setupLmdbStore()\n  }\n  return dataStore\n}\n\nconst gatsbyRedux = requireFromInstalledGatsbyDist(`redux/index.js`)\n\n// this will log twice if we're hooking into the gatsby emitter\nif (!gatsbyRedux?.emitter) {\n  // It is possible that the store is not initialized yet when calling `DELETE_CACHE`.\n  //  The code below ensures we wipe cache from the proper store\n  //  (mostly relevant for tests)\n  emitter.on(`DELETE_CACHE`, () => {\n    getDataStore()\n  })\n}\n"],"mappings":";;;;AAAA;AAEA;AAEA,IAAIA,SAAqB;AAElB,SAASC,YAAY,GAAe;EACzC,IAAI,CAACD,SAAS,EAAE;IACd,MAAM;MAAEE;IAAe,CAAC,GAAGC,OAAO,CAAE,uBAAsB,CAAC;IAC3DH,SAAS,GAAGE,cAAc,EAAE;EAC9B;EACA,OAAOF,SAAS;AAClB;AAEA,MAAMI,WAAW,GAAG,IAAAC,qDAA8B,EAAE,gBAAe,CAAC;;AAEpE;AACA,IAAI,EAACD,WAAW,aAAXA,WAAW,eAAXA,WAAW,CAAEE,OAAO,GAAE;EACzB;EACA;EACA;EACAA,cAAO,CAACC,EAAE,CAAE,cAAa,EAAE,MAAM;IAC/BN,YAAY,EAAE;EAChB,CAAC,CAAC;AACJ"}